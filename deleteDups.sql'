/*SELECT e.first_name, e.last_name, e.salary,
  d.name as department_name
FROM employees   AS e
JOIN departments AS d ON e.department_id = d.id;


select * from employees e1 left outer join 
(select max(id) id,department_id
from employees
group by department_id)e2
on e1.id=e2.id
where e2.id is null */

#select @rowid:=max(rowid)  from employees group by department_id;
#select * from employees where rowid!=@rowid

/*with recursive cte as
(
  select department_id, row_number() over(partition by department_id order by department_id) rn
  from employees
  )
  select * from cte where rn<>1 ; */
  
/*delete  e1 
from employees e1, employees e2
where e1.department_id=e2.department_id
and e1.id>e2.id; */

select * from employees; 


rollback

/*delete e1 from employees e1 left outer join  
employees e2
on e1.department_id=e2.department_id where e1.id>e2.id */